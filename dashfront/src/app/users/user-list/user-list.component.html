<style>
  .main-container {
    display: flex;
    height: 100vh;
    background-image: url('assets/frontoffice/img/jj.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }

  .content-container {
    flex: 1;
    overflow-y: auto;
    padding: 40px 20px;
    background-color: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(5px);
    color: white;
  }

  .gradient-title {
    font-size: 1.5rem;
    font-weight: bold;
    text-align: left;
    background: linear-gradient(90deg, rgb(10, 125, 125), rgb(58, 6, 66));
    color: rgb(209, 238, 237);
    padding: 5px 20px;
    margin-bottom: 10px;
    display: inline-block;
  }

  .btn-group button {
    margin-right: 4px;
  }

  /* Table styling */
  table.table thead th {
    background-color: rgba(0, 0, 0, 0.6) !important;
    backdrop-filter: blur(2px);
    font-weight: bold;
    font-size: 0.9rem;
  }

  thead th.col-id { background-color: #2a2a2a !important; color: #f1c40f !important; }
  thead th.col-lastName { background-color: #2f2f3f !important; color: #e67e22 !important; }
  thead th.col-firstName { background-color: #222233 !important; color: #1abc9c !important; }
  thead th.col-username { background-color: #2a2a3f !important; color: #9b59b6 !important; }
  thead th.col-email { background-color: #1f2833 !important; color: #3498db !important; }
  thead th.col-phone { background-color: #283618 !important; color: #27ae60 !important; }
  thead th.col-address { background-color: #3a2c2c !important; color: #e74c3c !important; }
  thead th.col-createdAt { background-color: #264653 !important; color: #2a9d8f !important; }
  thead th.col-roles { background-color: #362c3d !important; color: #f39c12 !important; }
  thead th.col-actions { background-color: #222 !important; color: #fff !important; }

  table.table tbody td {
    background-color: rgba(3, 116, 94, 0.3);
    color: white;
    border-color: rgba(255, 255, 255, 0.1);
    vertical-align: middle;
    backdrop-filter: blur(3px);
    transition: background-color 0.3s ease;
  }

  table.table tbody tr:hover td {
    background-color: rgba(0, 0, 0, 0.3);
  }

  /* Modal */
  .modal {
    display: block;
    z-index: 1050;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-dialog {
    position: relative;
    margin: auto;
    top: 10%;
    max-width: 600px;
  }

  .modal-content {
    background-color: #1e1e1e;
    color: white;
    border: 1px solid #555;
    border-radius: 10px;
    padding: 20px;
  }

  .modal-body input, .modal-body select, .modal-body textarea {
    background-color: #2c2c2c;
    color: white;
    border: 1px solid #666;
  }

  .btn-close-white {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: white;
    cursor: pointer;
  }
</style>

<div class="main-container">
  <div class="content-container">
    <!-- Notification -->
    <div *ngIf="notificationMessage" class="alert alert-success alert-dismissible fade show w-100" role="alert" style="max-width: 700px;">
      {{ notificationMessage }}
      <button type="button" class="close" (click)="notificationMessage = ''" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h2 class="gradient-title" style="margin: 0;">Liste des Utilisateurs</h2>
      <a routerLink="/changer-role" style="font-size: 0.85rem; text-decoration: none; cursor: pointer; color: inherit;">
        Voulez-vous changer le rôle ?
      </a>
    </div>

    <!-- Tableau -->
    <div class="table-responsive" style="max-width: 1300px; width: 100%;">
      <table class="table table-sm table-hover text-center align-middle">
        <thead>
          <tr>
         <!--   <th class="col-id">ID</th> -->
            <th class="col-lastName">Nom</th>
            <th class="col-firstName">Prénom</th>
            <th class="col-username">Username</th>
            <th class="col-email">Email</th>
            <th class="col-phone">Tél</th>
            <th class="col-address">Adresse</th>
           <th class="col-createdAt">Créé le</th> 
      <!--        <th class="col-roles">Rôles</th> -->
            <th class="col-actions">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of users">
      <!--      <td class="col-id">{{ user.idUser }}</td> -->
            <td class="col-lastName">{{ user.lastName }}</td>
            <td class="col-firstName">{{ user.firstName }}</td>
            <td class="col-username">{{ user.username }}</td>
            <td class="col-email">{{ user.email }}</td>
            <td class="col-phone">{{ user.phoneNumber }}</td>
            <td class="col-address">{{ user.address }}</td>
          <td class="col-createdAt">{{ user.createdAt ? (user.createdAt | date:'dd/MM/yyyy HH:mm') : '-' }}</td> 
          <!--    <td class="col-roles">
              <span *ngFor="let role of user.roles; let isLast = last">
                {{ role.name }}<span *ngIf="!isLast">, </span>
              </span>
            </td>  -->
            <td class="col-actions">
              <div class="btn-group">
                <button class="btn btn-outline-info btn-sm" (click)="editUser(user)">
                  <i class="fa fa-edit"></i>
                </button>
                <button class="btn btn-outline-danger btn-sm" (click)="deleteUser(user.id)">
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Modal d'édition -->
    <div *ngIf="isEditing && selectedUser">
      <div class="modal">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Modifier l'utilisateur</h5>
              <button type="button" class="btn-close-white" (click)="cancelEdit()" aria-label="Close">&times;</button>
            </div>
            <form (ngSubmit)="saveUser()" #editForm="ngForm">
              <div class="modal-body">
                <div class="mb-3">
                  <label>Prénom :</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedUser.firstName" name="firstName" required>
                </div>
                <div class="mb-3">
                  <label>Nom :</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedUser.lastName" name="lastName" required>
                </div>
                <div class="mb-3">
                  <label>Username :</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedUser.username" name="username" required>
                </div>
                <div class="mb-3">
                  <label>Email :</label>
                  <input type="email" class="form-control" [(ngModel)]="selectedUser.email" name="email" required>
                </div>
                <div class="mb-3">
                  <label>Téléphone :</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedUser.phoneNumber" name="phoneNumber">
                </div>
                <div class="mb-3">
                  <label>Adresse :</label>
                  <input type="text" class="form-control" [(ngModel)]="selectedUser.address" name="address">
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Annuler</button>
                <button type="submit" class="btn btn-primary" [disabled]="!editForm.form.valid">Enregistrer</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
