<!-- PAGE ACTUALITÉS TRANSPARENTE -->
<style>
  .main-container {
    display: flex;
    height: 100vh;
    background-image: url('assets/frontoffice/img/jj.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }

  .content-container {
    flex: 1;
    overflow-y: auto;
    padding: 40px 20px;
    background-color: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(5px);
    color: white;
  }

  .gradient-title {
    font-size: 1.5rem;
    font-weight: bold;
    text-align: left;
    background: linear-gradient(90deg, rgb(10, 125, 125), rgb(58, 6, 66));
    color: rgb(209, 238, 237);
    padding: 5px 20px;
    margin-bottom: 10px;
    display: inline-block;
  }

  .btn-add {
    background-color: #747073;
    border: none;
    padding: 6px 12px;
    color: black;
    font-weight: bold;
    border-radius: 4px;
  }

  .table thead th {
    background-color: rgba(0, 0, 0, 0.6);
    color: #f1f1f1;
    font-weight: bold;
    font-size: 0.9rem;
    backdrop-filter: blur(2px);
  }

  .table tbody td {
  background-color: rgba(4, 150, 120, 0.3); /* vert foncé translucide */
    color: white;
    border-color: rgba(255, 255, 255, 0.1);
    vertical-align: middle;
    backdrop-filter: blur(3px);
    transition: background-color 0.3s ease;
  }

  .table tbody tr:hover td {
  background-color: rgba(0, 0, 0, 0.3);
  }

  .actualite-image {
    border-radius: 6px;
    max-height: 80px;
    object-fit: cover;
  }

  .modal {
    display: block;
    z-index: 1050;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-dialog {
    position: relative;
    margin: auto;
    top: 10%;
    max-width: 600px;
  }

  .modal-content {
    background-color: #1e1e1e;
    color: white;
    border: 1px solid #555;
    border-radius: 10px;
    padding: 20px;
  }

  .btn-close-white {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: rgb(0, 0, 0);
    cursor: pointer;
  }

  .modal-body input,
  .modal-body select {
    background-color: #2c2c2c;
    color: white;
    border: 1px solid #666;
  }

  .modal-body input:focus,
  .modal-body select:focus {
    border-color: #0d6efd;
    outline: none;
    box-shadow: 0 0 5px #0d6efd;
  }
</style>

<div class="main-container">
  <div class="content-container">
    <h2 class="gradient-title">✨ Liste des Actualités</h2>

    <div class="text-end mb-3">
      <button class="btn btn-add" (click)="showForm = !showForm">
        {{ showForm ? 'Fermer le formulaire' : 'Ajouter une Actualité' }}
      </button>
    </div>

    <!-- Formulaire d'ajout -->
    <div *ngIf="showForm" class="formulaire-ajout" style="max-width: 900px; margin: auto;">
      <form (ngSubmit)="onSubmit()">
        <div *ngIf="notificationMessage" class="alert alert-success alert-dismissible fade show" role="alert">
          {{ notificationMessage }}
          <button type="button" class="btn-close" (click)="notificationMessage = ''"></button>
        </div>

        <div class="mb-3">
          <label class="form-label text-light">Catégorie</label>
          <select [(ngModel)]="actuality" name="actuality" class="form-select" required>
            <option value="" disabled selected>Choisissez une catégorie</option>
            <option value="Ouverture officielle et présentation du programme">Ouverture officielle et présentation du programme</option>
            <option value="Ateliers pratiques et sessions de networking">Ateliers pratiques et sessions de networking</option>
            <option value="Mise en avant des offres d’emploi et de stage">Mise en avant des offres d’emploi et de stage</option>
            <option value="Rencontre avec les partenaires et sponsors">Rencontre avec les partenaires et sponsors</option>
            <option value="Conférences et panels sur les tendances du marché de l’emploi">Conférences et panels sur les tendances du marché de l’emploi</option>
            <option value="Clôture du forum et bilan des activités">Clôture du forum et bilan des activités</option>
            <option value="Activités de team-building">Team-building</option>
          </select>
        </div>

         <!-- Description -->
    <div class="mb-3">
      <label class="form-label text-light">Description</label>
      <textarea [(ngModel)]="description" name="description" class="form-control" rows="3" placeholder="Entrez une description..." required></textarea>
    </div>
    
        <div class="mb-3">
          <label class="form-label text-light">Image</label>
          <input type="file" (change)="fileUploaded($event)">
        </div>

        <div class="text-end">
          <button type="submit" class="btn btn-success">
            <i class="fas fa-check me-1"></i> Ajouter Actualité
          </button>
        </div>
      </form>
    </div>

    <!-- Tableau des actualités -->
    <div class="table-responsive mt-4">
      <table class="table table-sm table-hover text-center align-middle">
  <thead>
    <tr>
      <th>Catégorie</th>
      <th>Description</th>
      <th>Commentaires</th>
      <th>Likes</th>
      <th>Dislikes</th>
      <!--  <th>Date</th> -->
      <th>Image</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let actualite of actualites">
      <td>{{ actualite.actuality }}</td>
      <td>{{ actualite.description }}</td>
      <td>{{ actualite.commentaire?.length || 0 }}</td>
      <td>{{ actualite.likesCount }}</td>
      <td>{{ actualite.dislikesCount }}</td>
    <!--  <td>{{ actualite.datePub | date:'mediumDate' }}</td> -->
      <td>
        <img *ngIf="actualite.imageUrl" [src]="actualite.imageUrl" class="actualite-image" />
        <span *ngIf="!actualite.imageUrl">Aucune</span>
      </td>
      <td>
        <button class="btn btn-outline-info btn-sm me-1" (click)="editActualite(actualite)">
          <i class="fa fa-edit"></i>
        </button>
        <button class="btn btn-outline-danger btn-sm" (click)="deleteActualite(actualite.idActualite)">
          <i class="fa fa-trash"></i>
        </button>
      </td>
    </tr>
  </tbody>
</table>

    </div>

    <!-- Modal édition -->
    <div *ngIf="isModalOpen">
      <div class="modal" (click)="closeAddModal()">
        <div class="modal-dialog" (click)="$event.stopPropagation()">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">{{ isEditing ? 'Modifier Actualité' : 'Ajouter Actualité' }}</h5>
              <button type="button" class="btn-close-white" (click)="closeAddModal()">&times;</button>
            </div>

            <form [formGroup]="actualiteForm" (ngSubmit)="isEditing ? updateActualite() : addActualite()">
              <div class="modal-body">
                <div class="mb-3">
                  <label>Catégorie</label>
                  <select formControlName="actuality" class="form-select">
                    <option value="">Choisir une catégorie</option>
                    <option value="Lancement de forum">Lancement de forum</option>
                    <option value="Annonce importante">Annonce importante</option>
                    <option value="Nouveautés entreprises">Nouveautés entreprises</option>
                    <option value="Rétrospective d'événement">Rétrospective d'événement</option>
                  </select>
                </div>

                <div class="mb-3">
                  <label>Image</label>
                  <input type="file" (change)="onFileSelected($event)" class="form-control" />
                  <div *ngIf="imagePreview" class="mt-2">
                    <img [src]="imagePreview" alt="Preview" style="max-width: 100%; max-height: 200px; border-radius: 5px;" />
                  </div>
                </div>
              </div>

              <div class="modal-footer">
                <button type="submit" class="btn btn-primary" [disabled]="actualiteForm.invalid">
                  {{ isEditing ? 'Enregistrer' : 'Ajouter' }}
                </button>
                <button type="button" class="btn btn-secondary" (click)="closeAddModal()">Fermer</button>
              </div>
            </form>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
